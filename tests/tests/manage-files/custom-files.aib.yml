name: add_files
content:
  make_dirs:
    - path: /etc/custom-files
    - path: /etc/test-glob
    - path: /etc/test-glob-preserve
    - path: /etc/test-glob-preserve-log

  add_files:
    - path: /etc/custom-files/file1.txt
      source_path: custom-files.aib.yml

    - path: /etc/custom-files/file2.txt
      text: |
        This is the file content

    - path: /etc/custom-files/file3.txt
      url: "https://gitlab.com/CentOS/automotive/src/automotive-image-builder/-/raw/main/README.md?ref_type=heads&inline=false"

    # Test basic glob pattern (flatten files)
    - path: /etc/test-glob
      source_glob: "test-data/*.txt"
      preserve_path: false

    # Test glob pattern recursive (flatten files)
    - path: /etc/test-glob-preserve-log
      source_glob: "test-data/**/*.log"
      preserve_path: false

    # Test large glob pattern with path preservation
    # Limit to 100 files to test max_files functionality
    - path: /etc/test-glob-preserve
      source_glob: "test-data/**/*"
      preserve_path: true
      max_files: 100

  chmod_files:
    - path: /etc/custom-files/file1.txt
      mode: "777"
  chown_files:
    - path: /etc/custom-files/file1.txt
      user: nobody
      group: nobody
  rpms:
    - cronie
  remove_files:
    # This file is installed by cronie package
    - path: /usr/sbin/crond

qm:
  content:
    make_dirs:
      - path: /etc/qm-custom
    add_files:
      - path: /etc/qm-custom/file4.txt
        text: |
          This is the qm file content
      - path: /etc/qm-custom/file5.txt
        text: |
          This is another qm file content
    chmod_files:
      - path: /etc/qm-custom/file4.txt
        mode: "777"
    chown_files:
      - path: /etc/qm-custom/file4.txt
        user: nobody
        group: nobody
    rpms:
      - cups
    remove_files:
      # This file is installed by cups package
      - path: /usr/sbin/cupsd
