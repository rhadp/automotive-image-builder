summary: a-i-b tests running on pre-provisioned machine or VM

environment:
    # Base repository where a-i-b and its dependencies should be installed from
    AIB_BASE_REPO: https://autosd.sig.centos.org/AutoSD-9/nightly/repos/AutoSD/compose/AutoSD/${arch}/os/

    # IP or hostname of a node, where tests will be executed
    NODE: ""

    # SSH key used to authenticate to above NODE
    NODE_SSH_KEY: "~/.ssh/aib-tests"

    AIB: automotive-image-builder
    OUTDIR: /tmp/aib_testdir
    BUILDDIR: $OUTDIR/build
    RUNDIR: $OUTDIR/run

provision:
    how: connect
    guest: $NODE
    user: root
    key: $NODE_SSH_KEY

prepare:
    - name: Setup repositories
      how: shell
      script: |
          ./scripts/setup-repos.sh

    - name: Install a-i-b
      how: install
      package:
          - automotive-image-builder

    - name: Report a-i-b version
      how: shell
      script: |
         rpm -qi automotive-image-builder

discover:
    how: fmf

execute:
    how: tmt

report:
    how: junit

